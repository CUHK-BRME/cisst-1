#
# $Id: CMakeLists.txt,v 1.7 2007/04/26 20:12:05 anton Exp $
#

# (C) Copyright 2005-2007 Johns Hopkins University (JHU), All Rights
# Reserved.

# --- begin cisst license - do not edit ---
# 
# This software is provided "as is" under an open source license, with
# no warranty.  The complete license can be found in license.txt and
# http://www.cisst.org/cisst/license.txt.
# 
# --- end cisst license ---

# CMakeLists.txt for cisstNumerical wrapping tests

# Keep a list all tests for ctest/Dart
SET(DART_TEST_FILE ${CMAKE_CURRENT_BINARY_DIR}/DartTestfile-cisstNumericalPython.txt)
SET(DART_TEST_FILE_AUTO ${CMAKE_CURRENT_BINARY_DIR}/DartTestfile-cisstNumericalPython-auto.txt)
FILE(WRITE ${DART_TEST_FILE} "# File generated by CMake, do not modify\n")

# Create the scripts from .in
SET(LIB cisstNumerical)
IF(CMAKE_CONFIGURATION_TYPES)
  FOREACH(config ${CMAKE_CONFIGURATION_TYPES})
    CONFIGURE_FILE(${cisstWrappingTests_SOURCE_DIR}/cisstTestMain.py.in
                   ${EXECUTABLE_OUTPUT_PATH}/${config}/cisstNumericalTests.py
                   IMMEDIATE @ONLY@)
  ENDFOREACH(config)
ELSE(CMAKE_CONFIGURATION_TYPES)
  CONFIGURE_FILE(${cisstWrappingTests_SOURCE_DIR}/cisstTestMain.py.in
                 ${EXECUTABLE_OUTPUT_PATH}/cisstNumericalTests.py
                 IMMEDIATE @ONLY@)
ENDIF(CMAKE_CONFIGURATION_TYPES)

      
# Run the script to generate the list of tests automatically
ADD_CUSTOM_TARGET(cisstNumerical_CREATE_PYTHON_TESTS_LIST ALL
                  ${PYTHON_EXECUTABLE} ${EXECUTABLE_OUTPUT_PATH}/${CMAKE_CFG_INTDIR}/cisstNumericalTests.py
                  -d ${PYTHON_EXECUTABLE} > ${DART_TEST_FILE_AUTO})

ADD_DEPENDENCIES(cisstNumerical_CREATE_PYTHON_TESTS_LIST
                 cisstCommon
                 cisstVector
                 cisstNumerical
                 _cisstCommonPython
                 _cisstVectorPython
                 _cisstNumericalPython)

FILE(APPEND ${DART_TEST_FILE} "INCLUDE(\"${DART_TEST_FILE_AUTO}\")\n")


# Add all the test lists
SET_DIRECTORY_PROPERTIES(PROPERTIES TEST_INCLUDE_FILE
                         ${DART_TEST_FILE})
                         

